{# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   Layout: Kitchen Display System (KDS)
   Extends: base.html  (overrides {% block body_layout %})
   Full-screen, auto-refresh, timer-based.
   Used by: Taqueros, Comal, Bebidas

   Usage:
     {% extends 'layouts/_layout_kds.html' %}
     {% block page_title %}Taqueros{% endblock %}
     {% set kds_station = 'taqueros' %}
     {% set kds_label = 'Taqueros' %}
     {% set kds_color = 'var(--cl-red-500)' %}
     {% block kds_content %}
       ...order cards...
     {% endblock %}
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• #}
{% extends 'base.html' %}

{% block title %}{% block page_title %}Cocina{% endblock %} â€” CasaLeones KDS{% endblock %}

{% block head %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/cocina_timers.css') }}?v={{ config.VERSION }}">
<style>
  /* KDS full-screen overrides */
  body { overflow: hidden; overflow-y: auto; }
  .cl-kds { display: flex; flex-direction: column; height: 100vh; background: var(--cl-bg-primary); }
  .cl-kds__topbar {
    display: flex; align-items: center; justify-content: space-between;
    padding: var(--cl-space-3) var(--cl-space-4);
    background: var(--cl-gray-900); color: #fff;
    flex-shrink: 0; min-height: 56px;
  }
  .cl-kds__station {
    display: flex; align-items: center; gap: var(--cl-space-3);
    font-size: var(--cl-text-lg); font-weight: var(--cl-font-semibold);
  }
  .cl-kds__station-dot {
    width: 12px; height: 12px; border-radius: 50%;
    background: {{ kds_color|default('var(--cl-red-500)') }};
    animation: kds-pulse 2s ease-in-out infinite;
  }
  @keyframes kds-pulse { 0%,100%{ opacity:1; } 50%{ opacity:.5; } }
  @media (prefers-reduced-motion: reduce) { .cl-kds__station-dot { animation: none; } }
  .cl-kds__stats { display: flex; gap: var(--cl-space-5); align-items: center; }
  .cl-kds__stat { display: flex; flex-direction: column; align-items: center; gap: 2px; }
  .cl-kds__stat-value { font-size: var(--cl-text-xl); font-weight: var(--cl-font-bold); }
  .cl-kds__stat-label { font-size: var(--cl-text-xs); opacity: .7; }
  .cl-kds__grid {
    flex: 1; overflow-y: auto; padding: var(--cl-space-4);
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: var(--cl-space-4);
    align-content: start;
  }
  .cl-kds__empty {
    grid-column: 1 / -1; display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    min-height: 50vh; opacity: .5;
  }
  .cl-kds__empty i { width: 64px; height: 64px; margin-bottom: var(--cl-space-4); }
  .cl-kds__actions { display: flex; gap: var(--cl-space-2); align-items: center; }
</style>
{% endblock %}

{% block body_layout %}
  <a href="#main-content" class="skip-to-content">Saltar al contenido</a>
  <div class="cl-kds">
    {# â”€â”€ KDS Topbar â”€â”€ #}
    <header class="cl-kds__topbar">
      <div class="cl-kds__station">
        <div class="cl-kds__station-dot"></div>
        <span>{{ kds_label|default('Cocina') }}</span>
      </div>

      <div class="cl-kds__stats">
        {% block kds_stats %}
        <div class="cl-kds__stat" role="status" aria-label="Ã“rdenes pendientes">
          <span class="cl-kds__stat-value" id="kdsPendingCount">â€”</span>
          <span class="cl-kds__stat-label">Pendientes</span>
        </div>
        <div class="cl-kds__stat" role="status" aria-label="Tiempo promedio">
          <span class="cl-kds__stat-value" id="kdsAvgTime">â€”</span>
          <span class="cl-kds__stat-label">Tiempo prom.</span>
        </div>
        {% endblock %}
      </div>

      <div class="cl-kds__actions">
        <button class="cl-topbar__icon-btn" id="darkModeToggle"
                aria-label="Alternar modo oscuro" title="Modo oscuro"
                style="color:#fff">
          <span id="darkModeIcon">ğŸŒ™</span>
        </button>
        {% if current_user.is_authenticated and current_user.rol in ['admin','superadmin'] %}
        <a href="{{ url_for('admin.dashboard') }}" class="cl-topbar__icon-btn" style="color:#fff"
           title="Panel Admin" aria-label="Panel Admin">
          <i data-lucide="layout-dashboard" class="icon-sm"></i>
        </a>
        {% endif %}
        <a href="{{ url_for('auth.logout') }}" class="cl-topbar__icon-btn" style="color:#fff"
           title="Cerrar sesiÃ³n" aria-label="Cerrar sesiÃ³n">
          <i data-lucide="log-out" class="icon-sm"></i>
        </a>
      </div>
    </header>

    {# â”€â”€ Order cards grid â”€â”€ #}
    <main class="cl-kds__grid" id="main-content" aria-live="polite" aria-label="Ã“rdenes pendientes">
      {% block kds_content %}
      <div class="cl-kds__empty">
        <i data-lucide="chef-hat"></i>
        <p>No hay Ã³rdenes pendientes</p>
      </div>
      {% endblock %}
    </main>
  </div>
{% endblock body_layout %}
